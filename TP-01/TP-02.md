# T1592 - Collecte d'informations sur l'h√¥te cible

## MITRE ATT&CK - Tactique : Reconnaissance

**ID** : T1592  
**Tactique** : Reconnaissance  
**Plateformes concern√©es** : Toutes  
**Permissions requises** : Aucune  
**Sources de donn√©es** : Analytique web, analyse des protocoles r√©seau, surveillance des fichiers  

---

## üîé Description

Un attaquant peut chercher √† r√©cup√©rer des informations sur les machines cibles afin de mieux pr√©parer une intrusion. Cette phase d'observation pr√©liminaire se d√©roule g√©n√©ralement en amont d'une op√©ration malveillante. Les informations collect√©es peuvent inclure :

- Adresses IP attribu√©es  
- Noms d'h√¥tes  
- Syst√®mes d'exploitation (OS)  
- Architecture mat√©rielle  
- R√¥le de l'h√¥te (ex: serveur web, serveur de messagerie)  
- Services actifs  
- Interfaces r√©seau  
- Configurations syst√®me  
- Logiciels et firmwares install√©s  
- D√©tails mat√©riels (CPU, RAM, p√©riph√©riques)  

Ces informations permettent aux adversaires d'identifier les cibles potentielles et d'optimiser leurs m√©thodes d'attaque. Cette approche est particuli√®rement exploit√©e dans des op√©rations discr√®tes √† long terme, comme celles men√©es par des groupes parrain√©s par des √âtats tels que **Volt Typhoon** ([Rapport CISA](https://www.cisa.gov/sites/default/files/2024-03/aa24-038a_csa_prc_state_sponsored_actors_compromise_us_critical_infrastructure_3.pdf)).

---

## üéØ Sc√©nario d'attaque sur 192.168.45.63

### üßæ Profil de la cible (exemple fictif)

- **Adresse IP** : `192.168.45.63`  
- **Nom d'h√¥te** : `internal-core-scan.local`  
- **R√¥le** : Dispositif r√©seau central en segment ICS  
- **Syst√®me** : Ubuntu Server 20.04 LTS  
- **Architecture** : x86_64  
- **Interfaces** : eth0 (LAN), tun0 (VPN)  
- **Services expos√©s** :  
  - Port 22 ‚Üí OpenSSH_8.9p1  
  - Port 80 ‚Üí Apache/2.4.52 (Ubuntu)  
- **Pr√©fixe MAC** : Cisco Systems, Inc.  
- **Dernier signalement** : 31 mars 2025  
- **Indication firmware** : Intel AMT activ√© sur la carte m√®re  
- **R√©solution DNS inverse** : "core-sensor.local"  

### üìã Plan d'attaque bas√© sur T1592

#### Phase 1 : Reconnaissance passive (z√©ro contact)
- Analyse WHOIS et requ√™tes DNS publiques  
- Recherche de fichiers de configuration fuit√©s via `Google Dorking`  
- Recueil de donn√©es via Shodan/Censys ‚Üí d√©tection des ports 22 et 80  
- Exploitation de sources OSINT ‚Üí identification des conventions de nommage interne (`core-`, `scan-`, `-local`)  
- D√©couverte d'une carte r√©seau dans un d√©p√¥t GitHub abandonn√©  

#### Phase 2 : Profilage de l'infrastructure
- Validation de fuites DNS via `nslookup` et `dig`  
- Collecte de banni√®res de service via un script Python  
- Extraction de la version d'Apache ‚Üí vuln√©rabilit√© CVE-2022-23943 d√©tect√©e  
- Identification d'Intel AMT via analyse des pr√©fixes MAC  
- Test SNMPwalk (UDP 161) ‚Üí r√©cup√©ration des informations syst√®me (SNMP v2c - cha√Æne communautaire par d√©faut)  

#### Phase 3 : Scan actif *(dernier recours pour √©viter la d√©tection pr√©coce)*
- Scan furtif Nmap (`-sS -sV -O -Pn`) sur `192.168.45.63`  
- Ex√©cution du script **banner_grabber.py** pour confirmer les services actifs  
- Confirmation du retard de mise √† jour d'Apache  
- D√©tection d'un uptime > 180 jours ‚Üí forte probabilit√© de syst√®me non patch√©  

#### Phase 4 : Exploitation des informations collect√©es
- Tentative de connexion SSH avec des identifiants par d√©faut (refus√©)  
- Exploration HTTP ‚Üí identification d'un endpoint `/status` exposant des m√©tadonn√©es internes  
- D√©tection d'un partage SMB ouvert sur l'h√¥te voisin `192.168.45.62` (potentiel d'escalade lat√©rale)  

---

## üîó Ressources et r√©f√©rences

- [MITRE ATT&CK T1592](https://attack.mitre.org/techniques/T1592/)  
- [Sous-techniques de T1592](https://attack.mitre.org/techniques/T1592/)  
- [Volt Typhoon - Rapport CISA](https://www.cisa.gov/sites/default/files/2024-03/aa24-038a_csa_prc_state_sponsored_actors_compromise_us_critical_infrastructure_3.pdf)  

---

## üîê Contre-mesures

- Surveiller les requ√™tes DNS et WHOIS suspectes  
- Restreindre les acc√®s aux informations internes  
- Filtrer les scans externes sur le pare-feu  
- D√©sactiver les services non n√©cessaires  
- Durcir les configurations SNMP, NetBIOS et RPC  

---

## ‚öíÔ∏è Outils et techniques associ√©es

| Outil/M√©thode           | Description                                   |
|------------------------|----------------------------------------------|
| WHOIS                 | Recherche d'informations sur les domaines    |
| nslookup / dig        | Extraction de donn√©es DNS                   |
| Shodan / Censys       | D√©tection de services expos√©s               |
| Nmap                  | Scan de ports et d√©tection d'OS              |
| SNMPwalk              | Collecte d'infos sur les syst√®mes SNMP       |

Exemple de scan :
```bash
nmap -sV -O 192.168.45.63
